%featureCountCombined, 
%trueFeatureCountCombined
%Fgt: trueSampsonErr
%Fgt: trueErrorStdDev
%Fgt: trueRootSampsonErr, 
%Fgt: trueRootErrorStdDev,
%refined F: inlierCountCombined, 
%refined F: trueInlierCountCombined, 
%refined F: sampsonErrCombined, 
%refined F: trueSampsonErr, 
%refined F: trueSampsonErrStdDev, 
%refined F: trueRootSampsonErr, 
%refined F: trueRootSampsonErrStdDev, 
%F_Points: featureCountGood, 
%F_Points: trueFeatureCountGood, 
%F_Points: featureCountComplete, 
%F_Points: trueFeatureCountComplete, 
%F_Points: inlierCountOwnGood, 
%F_Points: trueInlierCountOwnGood, 
%F_Points: inlierCountOwnComplete, 
%F_Points: trueInlierCountOwnComplete, 
%F_Points: inlierCountCombined, 
%F_Points: trueInlierCountCombined, 
%F_Points: sampsonErrOwn, 
%F_Points: sampsonErrComplete, 
%F_Points: sampsonErrCombined, 
%F_Points: sampsonErrStdDevCombined, 
%F_Points: trueSampsonErr, 
%F_Points: trueSampsonErrStdDev, 
%F_Points: trueRootSampsonErr, 
%F_Points: trueRootSampsonErrStdDev, 
%F_Points: quality, 
%H_Lines: featureCountGood, 
%H_Lines: trueFeatureCountGood, 
%H_Lines: featureCountComplete, 
%H_Lines: trueFeatureCountComplete, 
%H_Lines: inlierCountOwnGood, 
%H_Lines: trueInlierCountOwnGood, 
%H_Lines: inlierCountOwnComplete, 
%H_Lines: trueInlierCountOwnComplete, 
%H_Lines: inlierCountCombined, 
%H_Lines: trueInlierCountCombined, 
%H_Lines: sampsonErrOwn, 
%H_Lines: sampsonErrComplete, 
%H_Lines: sampsonErrCombined, 
%H_Lines: sampsonErrStdDevCombined, 
%H_Lines: trueSampsonErr, 
%H_Lines: trueSampsonErrStdDev, 
%H_Lines: trueRootSampsonErr, 
%H_Lines: trueRootSampsonErrStdDev, 
%H_Lines: quality, 
%H_Points: featureCountGood, 
%H_Points: trueFeatureCountGood, 
%H_Points: featureCountComplete, 
%H_Points: trueFeatureCountComplete, 
%H_Points: inlierCountOwnGood, 
%H_Points: trueInlierCountOwnGood, 
%H_Points: inlierCountOwnComplete, 
%H_Points: trueInlierCountOwnComplete, 
%H_Points: inlierCountCombined, 
%H_Points: trueInlierCountCombined, 
%H_Points: sampsonErrOwn, 
%H_Points: sampsonErrComplete, 
%H_Points: sampsonErrCombined,  
%H_Points: sampsonErrStdDevCombined, 
%H_Points: trueSampsonErr, 
%H_Points: trueSampsonErrStdDev, 
%H_Points: trueRootSampsonErr, 
%H_Points: trueRootSampsonErrStdDev, 
%H_Points: quality, 
%time (min)

%first image, second image, featureCountCombined,, trueFeatureCountCombined,, Fgt: trueSampsonErr,, Fgt: trueErrorStdDev,, Fgt: trueRootSampsonErr,, Fgt: trueRootErrorStdDev,, refined F: inlierCountCombined,, refined F: trueInlierCountCombined,, refined F: sampsonErrCombined,, refined F: trueSampsonErr,, refined F: trueSampsonErrStdDev,, refined F: trueRootSampsonErr,, refined F: trueRootSampsonErrStdDev,, F_Points: featureCountGood,, F_Points: trueFeatureCountGood,, F_Points: featureCountComplete,, F_Points: trueFeatureCountComplete,, F_Points: inlierCountOwnGood,, F_Points: trueInlierCountOwnGood,, F_Points: inlierCountOwnComplete,, F_Points: trueInlierCountOwnComplete,, F_Points: inlierCountCombined,, F_Points: trueInlierCountCombined,, F_Points: sampsonErrOwn,, F_Points: sampsonErrComplete,, F_Points: sampsonErrCombined,, F_Points: sampsonErrStdDevCombined,, F_Points: trueSampsonErr,, F_Points: trueSampsonErrStdDev,, F_Points: trueRootSampsonErr,, F_Points: trueRootSampsonErrStdDev,, F_Points: quality,, H_Lines: featureCountGood,, H_Lines: trueFeatureCountGood,, H_Lines: featureCountComplete,, H_Lines: trueFeatureCountComplete,, H_Lines: inlierCountOwnGood,, H_Lines: trueInlierCountOwnGood,, H_Lines: inlierCountOwnComplete,, H_Lines: trueInlierCountOwnComplete,, H_Lines: inlierCountCombined,, H_Lines: trueInlierCountCombined,, H_Lines: sampsonErrOwn,, H_Lines: sampsonErrComplete,, H_Lines: sampsonErrCombined,, H_Lines: sampsonErrStdDevCombined,, H_Lines: trueSampsonErr,, H_Lines: trueSampsonErrStdDev,, H_Lines: trueRootSampsonErr,, H_Lines: trueRootSampsonErrStdDev,, H_Lines: quality,, H_Points: featureCountGood,, H_Points: trueFeatureCountGood,, H_Points: featureCountComplete,, H_Points: trueFeatureCountComplete,, H_Points: inlierCountOwnGood,, H_Points: trueInlierCountOwnGood,, H_Points: inlierCountOwnComplete,, H_Points: trueInlierCountOwnComplete,, H_Points: inlierCountCombined,, H_Points: trueInlierCountCombined,, H_Points: sampsonErrOwn,, H_Points: sampsonErrComplete,, H_Points: sampsonErrCombined,, H_Points: sampsonErrStdDevCombined,, H_Points: trueSampsonErr,, H_Points: trueSampsonErrStdDev,, H_Points: trueRootSampsonErr,, H_Points: trueRootSampsonErrStdDev,, H_Points: quality,, time (min)

%function [rms, stddev] = rootMeanStdDev(x)
%	res = 0;
%	for i = 1:rows(data)
		
%	endfor
%endfunction

data = csvread("Results/resultList_raw_data.csv");
result = zeros(rows(data)/10, 2*columns(data));
result_small = zeros(rows(data)/10, 10);
F_point_sel=0;
F_hpoint_sel=0;
F_hline_sel=0;

F_point_good_results=0;
F_hpoint_good_results=0;
F_hline_good_results=0;
F_final_good_results=0;

evaluation_small = zeros(100, 10);
k = 1;
for i = 1:10:rows(data) 
	for j = 1:columns(data)
		col = data([i:i+9],j);
		#printf("rows: %f\n", i);
	    #printf("z(%d,%d) = %f\n", i, j, z(i,j));
		
		if (j == 3 || j == 9 || j == 10 || j == 24 || j == 25 || j == 26 || j == 28 || j == 43 || j == 44 || j == 45 || j == 47 || j == 62 || j  == 63 || j == 64 || j == 66)
			sqrt(col);
		endif

		if(!isnumeric(col(1,1)) || col(1,1) == -1) 
			result(k, 2*j-1) = -1;
			result(k, 2*j) = -1;
		else
			result(k, 2*j-1) = mean(col);
			result(k, 2*j) = std(col);
		

			if (j == 3)				
				result_small(k,1) = result(k, 2*j-1);
				result_small(k,2) = result(k, 2*j);
			elseif (j == 10)
				result_small(k,3) = result(k, 2*j-1);
				result_small(k,4) = result(k, 2*j);
			elseif (j == 28)
				result_small(k,5) = result(k, 2*j-1);
				result_small(k,6) = result(k, 2*j);
			elseif (j == 47)
				result_small(k,7) = result(k, 2*j-1);
				result_small(k,8) = result(k, 2*j);
			elseif (j == 66)
				result_small(k,9) = result(k, 2*j-1);
				result_small(k,10) = result(k, 2*j);
			endif

		endif
	endfor
	k++;	
endfor

for i = 1:rows(data) 
	if (data(i,32) > data(i,51) && data(i,32) > data(i,70))
			F_point_sel++;
	elseif (data(i,51) > data(i,32) && data(i,51) > data(i,70))
			F_hpoint_sel++;
	elseif (data(i,70) > data(i,51) && data(i,70) > data(i,32))
			F_hline_sel++;
	endif

	if (data(i,28) < 10)
		F_point_good_results++;
	endif
	if (data(i,47) < 10)
		F_hpoint_good_results++;
	endif
	if (data(i,66) < 10)
		F_hline_good_results++;
	endif
	if (data(i,10) < 10)
		F_final_good_results++;
	endif
endfor

F_point_sel
F_hpoint_sel
F_hline_sel

F_point_good_results
F_hpoint_good_results
F_hline_good_results
F_final_good_results

k=1;
for t = 0.1:0.1:10
	evaluation_small(k, 2) = t;
	for j = 3:2:10
		for i = 1:rows(result_small) 
			if(result_small(i,j) > 0.01 && result_small(i,j) < t)
				evaluation_small(k, j) += result_small(i,j);
				evaluation_small(k, j + 1)++;
			endif	
		endfor 
		if(evaluation_small(k, j + 1) > 0) 
			evaluation_small(k, j) / evaluation_small(k, j + 1);
		endif
	endfor
	k++;
endfor 


%Fgt: trueSampsonErr,,
msize=8;
lwidth=1.5;
fontsize=20;

h1=figure("Position",[0,0,800,600]);
plot (evaluation_small([1:100],2), evaluation_small([1:100],3), ":ko", "markersize", msize, "linewidth", lwidth, evaluation_small([1:100],2), evaluation_small([1:100],5), ":go", "markersize", msize, "linewidth", lwidth,  evaluation_small([1:100],2), evaluation_small([1:100],7), ":bo", "markersize", msize, "linewidth", lwidth, evaluation_small([1:100],2), evaluation_small([1:100],9), ":ro", "markersize", msize, "linewidth", lwidth);

#title ("");
xlabel ("Error threshold", "fontsize", fontsize);
ylabel ("Img. pair mean RMS error", "fontsize", fontsize);
l = legend ("final result", "from points", "from line homog.", "from point homog.", "location", "northwest");
set (l, "fontsize", fontsize);
set(gca, "fontsize", fontsize)


h2=figure("Position",[0,0,800,600]);
plot (evaluation_small([1:100],2), evaluation_small([1:100],4), ":ko", "markersize", msize, "linewidth", lwidth, evaluation_small([1:100],2), evaluation_small([1:100],6), ":go", "markersize", msize, "linewidth", lwidth, evaluation_small([1:100],2), evaluation_small([1:100],8), ":bo", "markersize", msize, "linewidth", lwidth, evaluation_small([1:100],2), evaluation_small([1:100],10), ":ro", "markersize", msize, "linewidth", lwidth, "markersize", msize, "linewidth", lwidth); 

xlabel ("Error threshold", "fontsize", fontsize);
ylabel ("Img. pairs with mean RMS error below threshold", "fontsize", fontsize);
l = legend ("final result", "from points", "from line homog.", "from point homog.", "location", "east");
set (l, "fontsize", fontsize);
set(gca, "fontsize", fontsize)

max_error = 20;

k=1;
for i = 1:rows(data) 
	if(data(i,10) > 0 && data(i,10) < max_error)
		plot_data_u(k, :) = [data(i,10), data(i,1), data(i,2), data(i,7), data(i,8)];
		k++;
	endif
endfor

%plot_data_u

%[plot_data, idx] = sortrows(plot_data_u, 1);

%plot_data

h3=figure("Position",[0,0,800,600]);

plot (plot_data_u(:,1), plot_data_u(:,2), "ko", "markersize", msize, "linewidth", lwidth, plot_data_u(:,1), plot_data_u(:,3), "rx", "markersize", msize, "linewidth", lwidth, plot_data_u(:,1), plot_data_u(:,4), "bo", "markersize", msize, "linewidth", lwidth, plot_data_u(:,1), plot_data_u(:,5), "mx", "markersize", msize, "linewidth", lwidth, "markersize", msize, "linewidth", lwidth); 


xlabel ("RMS error", "fontsize", fontsize);
ylabel ("Number of inlier", "fontsize", fontsize);
l = legend ("joint feature inlier", "thereof \"true\" inlier", "thereof result inlier", "thereof \"true\" inlier", "location", "northeast");
set (l, "fontsize", fontsize);
set(gca, "fontsize", fontsize)


k=1;
for i = 1:rows(data) 
	if(data(i,24) > 0 && data(i,24) < max_error)
		plot_data_p_u(k, :) = [data(i,24), data(i,18), data(i,19), data(i,20), data(i,21)];
		k++;
	endif
endfor

%[plot_data, idx] = sortrows(plot_data_p_u, 1);

%plot_data

h4=figure("Position",[0,0,800,600]);

plot (plot_data_p_u(:,1), plot_data_p_u(:,2), "ko", "markersize", msize, "linewidth", lwidth, plot_data_p_u(:,1), plot_data_p_u(:,3), "rx", "markersize", msize, "linewidth", lwidth, plot_data_p_u(:,1), plot_data_p_u(:,4), "bo", "markersize", msize, "linewidth", lwidth, plot_data_p_u(:,1), plot_data_p_u(:,5), "mx", "markersize", msize, "linewidth", lwidth, "markersize", msize, "linewidth", lwidth); 


xlabel ("RMS error", "fontsize", fontsize);
ylabel ("Number of inlier", "fontsize", fontsize);
l = legend ("RANSAC inlier", "thereof \"true\" inlier", "overall estimation inlier", "thereof \"true\" inlier", "location", "northeast");
set (l, "fontsize", fontsize);
set(gca, "fontsize", fontsize)


k=1;
for i = 1:rows(data) 
	if(data(i,43) > 0 && data(i,43) < max_error)
		plot_data_lh_u(k, :) = [data(i,43), data(i,37), data(i,38), data(i,39), data(i,40)];
		k++;
	endif
endfor

%[plot_data, idx] = sortrows(plot_data_lh_u, 1);

%plot_data

%plot_data_lh_u

h5=figure("Position",[0,0,800,600]);

plot (plot_data_lh_u(:,1), plot_data_lh_u(:,2), "ko", "markersize", msize, "linewidth", lwidth, plot_data_lh_u(:,1), plot_data_lh_u(:,3), "rx", "markersize", msize, "linewidth", lwidth, plot_data_lh_u(:,1), plot_data_lh_u(:,4), "bo", "markersize", msize, "linewidth", lwidth, plot_data_lh_u(:,1), plot_data_lh_u(:,5), "mx", "markersize", msize, "linewidth", lwidth, "markersize", msize, "linewidth", lwidth); 


xlabel ("RMS error", "fontsize", fontsize);
ylabel ("Number of inlier", "fontsize", fontsize);
l = legend ("RANSAC inlier", "thereof \"true\" inlier", "overall estimation inlier", "thereof \"true\" inlier", "location", "northeast");
set (l, "fontsize", fontsize);
set(gca, "fontsize", fontsize)


k=1;
for i = 1:rows(data) 
	if(data(i,62) > 0 && data(i,62) < max_error)
		plot_data_ph_u(k, :) = [data(i,62), data(i,56), data(i,57), data(i,58), data(i,59)];
		k++;
	endif
endfor

%[plot_data, idx] = sortrows(plot_data_ph_u, 1);

h6=figure("Position",[0,0,800,600]);

plot (plot_data_ph_u(:,1), plot_data_ph_u(:,2), "ko", "markersize", msize, "linewidth", lwidth, plot_data_ph_u(:,1), plot_data_ph_u(:,3), "rx", "markersize", msize, "linewidth", lwidth, plot_data_ph_u(:,1), plot_data_ph_u(:,4), "bo", "markersize", msize, "linewidth", lwidth, plot_data_ph_u(:,1), plot_data_ph_u(:,5), "mx", "markersize", msize, "linewidth", lwidth, "markersize", msize, "linewidth", lwidth); 


xlabel ("RMS error", "fontsize", fontsize);
ylabel ("Number of inlier", "fontsize", fontsize);
l = legend ("RANSAC inlier", "thereof \"true\" inlier", "overall estimation inlier", "thereof \"true\" inlier", "location", "northeast");
set (l, "fontsize", fontsize);
set(gca, "fontsize", fontsize)

#saveas (h1, "evaluation_small1.png");
#saveas (h2, "evaluation_small2.png");

%result_small

csvwrite("es_inlier_error_graph.csv", evaluation_small);
csvwrite("evaluation_small.csv", result_small);
csvwrite("evaluation.csv", result);
